---
phase: 04-stats-comprehension
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - seed/Presentation/Views/HistoryView.swift
  - seed/Presentation/Views/ComprehensionQuizView.swift
  - seed/Domain/Models/QuizQuestion.swift
  - seed/ContentView.swift
autonomous: true

must_haves:
  truths:
    - "User can view reading history with past sessions"
    - "History shows WPM trend over time"
    - "User can optionally take comprehension quiz after reading"
  artifacts:
    - path: "seed/Presentation/Views/HistoryView.swift"
      provides: "Session history dashboard"
      min_lines: 50
    - path: "seed/Presentation/Views/ComprehensionQuizView.swift"
      provides: "Quiz UI"
      min_lines: 40
    - path: "seed/Domain/Models/QuizQuestion.swift"
      provides: "Quiz model"
      min_lines: 10
  key_links:
    - from: "HistoryView"
      to: "SessionStore"
      via: "load sessions"
      pattern: "sessionStore\\.sessions|recentSessions"
    - from: "ComprehensionQuizView"
      to: "QuizQuestion"
      via: "display questions"
      pattern: "QuizQuestion|question\\.text"
---

<objective>
Reading history dashboard and optional comprehension quiz.

Purpose: Show performance over time and provide quiz for retention validation.
Output: HistoryView, ComprehensionQuizView, QuizQuestion model.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@seed/Domain/Models/AppSettings.swift
@seed/Data/SessionStore.swift
</context>

<tasks>

<task type="auto">
  <name>Create HistoryView</name>
  <files>seed/Presentation/Views/HistoryView.swift</files>
  <action>
Create SwiftUI view with SessionStore:
- List showing recent sessions (limit 20)
- Each row: date, WPM, duration, word count
- Sort by date descending (newest first)
- Empty state if no sessions
- Simple line chart showing WPM trend (last 10 sessions)

Use SF Symbols: chart.line.uptrend.xyaxis, clock.fill
Follow HIG patterns from 03-03.
No external chart library - use SwiftUI Path for simple line graph.
  </action>
  <verify>HistoryView displays sessions correctly</verify>
  <done>User can see reading history</done>
</task>

<task type="auto">
  <name>Add History tab to ContentView</name>
  <files>seed/ContentView.swift</files>
  <action>
Add HistoryView as tab in main TabView:
- SF Symbol: chart.line.uptrend.xyaxis
- Label: "History"
- Pass sessionStore to HistoryView

Tab order: Input → Reading → History
  </action>
  <verify>History tab appears and works</verify>
  <done>User can access history from main UI</done>
</task>

<task type="auto">
  <name>Create QuizQuestion model</name>
  <files>seed/Domain/Models/QuizQuestion.swift</files>
  <action>
Create struct QuizQuestion:
- text: String (question text)
- options: [String] (4 options)
- correctIndex: Int

For v1: Placeholder quiz with 3 hardcoded questions about RSVP reading.
NOT auto-generated from text (defer to v2 - requires LLM/complexity).

Example questions:
1. "What does RSVP help eliminate?" (options: eye movement, comprehension, speed, focus)
2. "How does anchoring work?" (options: bold first letters, color, size, position)
3. "What improves with RSVP practice?" (options: all of these, speed, focus, retention)
  </action>
  <verify>QuizQuestion model compiles</verify>
  <done>Quiz model ready for UI</done>
</task>

<task type="auto">
  <name>Create ComprehensionQuizView</name>
  <files>seed/Presentation/Views/ComprehensionQuizView.swift</files>
  <action>
Create SwiftUI view with hardcoded quiz questions:
- Display one question at a time
- 4 option buttons
- Show correct/incorrect feedback
- Track score (X/3)
- "Skip Quiz" button
- "Finish" shows final score

Present after CompletionStatsView dismissed (optional flow).
Simple, clean UI following HIG from 03-03.
  </action>
  <verify>Quiz UI works with hardcoded questions</verify>
  <done>User can take quiz after reading</done>
</task>

<task type="auto">
  <name>Wire quiz to completion flow</name>
  <files>seed/ContentView.swift</files>
  <action>
After CompletionStatsView dismissed:
- Show alert: "Take comprehension quiz?" (Yes/Skip)
- If Yes: present ComprehensionQuizView as sheet
- If Skip: return to input view

Optional flow, not blocking.
  </action>
  <verify>Quiz prompt appears after stats</verify>
  <done>User can optionally take quiz</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] HistoryView displays sessions
- [ ] WPM trend visible in simple chart
- [ ] Quiz questions display correctly
- [ ] Quiz flow works (skip or complete)
</verification>

<success_criteria>
- All tasks completed
- History dashboard functional
- Quiz UI works with hardcoded questions
- User can access both features
- No errors or warnings
</success_criteria>

<output>
After completion, create `.planning/phases/04-stats-comprehension/04-02-SUMMARY.md`
</output>
